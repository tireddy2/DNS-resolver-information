



ADD WG                                                          T. Reddy
Internet-Draft                                                    Akamai
Intended status: Standards Track                            M. Boucadair
Expires: October 9, 2022                                          Orange
                                                           April 7, 2022


                        DNS Resolver Information
                    draft-reddy-add-resolver-info-05

Abstract

   This document specifies a method for DNS resolvers to publish
   information about themselves.  Clients can use the resolver
   information to identify the capabilities of DNS resolvers.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on October 9, 2022.

Copyright Notice

   Copyright (c) 2022 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.




Reddy & Boucadair        Expires October 9, 2022                [Page 1]

Internet-Draft          DNS Resolver Information              April 2022


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   2
   3.  Retrieving Resolver Information . . . . . . . . . . . . . . .   3
   4.  Format of the Resolver Information  . . . . . . . . . . . . .   3
   5.  Resolver Information  . . . . . . . . . . . . . . . . . . . .   3
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .   5
   7.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   5
     7.1.  RESINFO RRtype  . . . . . . . . . . . . . . . . . . . . .   5
     7.2.  DNS Resolver Information Registration . . . . . . . . . .   5
   8.  Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .   6
   9.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   6
     9.1.  Normative References  . . . . . . . . . . . . . . . . . .   6
     9.2.  Informative References  . . . . . . . . . . . . . . . . .   7
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   8

1.  Introduction

   Historically, DNS stub resolvers communicated with recursive
   resolvers without needing to know anything about the features
   supported by these recursive resolvers.  As more and more recursive
   resolvers expose different features that may impact the delivered DNS
   service, means to help stub resolvers to identify the capabilities of
   the resolver are valuable.  Typically, stub resolvers can discover
   and authenticate encrypted DNS servers provided by a local network,
   for example, using the techniques specified in [I-D.ietf-add-dnr] and
   [I-D.ietf-add-ddr].  However, these stub resolvers need a means to
   retrieve information from the discovered recursive resolvers about
   their capabilities.

   This document fills that void by specifying a method for stub
   resolvers to retrieve such information.  To that aim, a new RRtype is
   defined for stub resolvers to query the recursive resolvers.  The
   information that a resolver might want to give is defined in
   Section 5.

   Retrieved information can be used to feed the server selection
   procedure.

2.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119][RFC8174] when, and only when, they appear in all
   capitals, as shown here.




Reddy & Boucadair        Expires October 9, 2022                [Page 2]

Internet-Draft          DNS Resolver Information              April 2022


   This document makes use of the terms defined in [RFC8499].

   'Encrypted DNS' refers to a DNS protocol that provides an encrypted
   channel between a DNS client and server (e.g., DoT, DoH, or DoQ).

3.  Retrieving Resolver Information

   A stub resolver that wants to retrieve the resolver information may
   use the RRtype "RESINFO" defined in this document (see Section 7.1).

   The content of the RDATA in a response to RRtype query is defined in
   Section 5.  If the resolver understands the RESINFO RRtype, the RRset
   in the Answer section MUST have exactly one record.

   The client can retrieve the resolver information using the RESINFO
   RRtype and QNAME of the domain name that is used to authenticate the
   DNS server (referred to as ADN in [I-D.ietf-add-dnr]).

   If the special use domain name "resolver.arpa" defined in
   [I-D.ietf-add-ddr] is used to discover the Encrypted DNS server, the
   client can retrieve the resolver information using the RESINFO RRtype
   and a QNAME of "resolver.arpa".

4.  Format of the Resolver Information

   The resolver information is returned as a JSON object.  Precisely,
   the JSON object MUST use the I-JSON message format [RFC7493].

      Note that [RFC7493] was based on [RFC7159], but [RFC7159] was
      replaced by [RFC8259].  Requiring the use of I-JSON instead of
      more general JSON format greatly increases the likelihood of
      interoperability.

   The JSON object returned by a DNS query may contain any name/value
   pairs.  All names MUST consist only of lower-case ASCII characters,
   digits, and hyphens (that is, Unicode characters U+0061 through 007A,
   U+0030 through U+0039, and U+002D).  These names MUST be 63
   characters or shorter.

   All names in the returned object MUST either be defined in the IANA
   registry Section 7.2 or begin with the substring "temp-" for names
   defined for local use only.

5.  Resolver Information

   The resolver information includes the following attributes:





Reddy & Boucadair        Expires October 9, 2022                [Page 3]

Internet-Draft          DNS Resolver Information              April 2022


   qnameminimization:  If the DNS server supports QNAME minimisation
      [RFC7816] to improve DNS privacy, the parameter value is set to
      true.  This is a mandatory attribute.

   extendeddnserror:  If the DNS server supports extended DNS error
      (EDE) [RFC8914] to return additional information about the cause
      of DNS errors, the parameter lists the possible extended DNS error
      codes that can be returned by the DNS server.  This is an optional
      attribute.

   resinfourl:  An URL that points to the generic unstructured resolver
      information (e.g., DoH APIs supported, possible HTTP status codes
      returned by the DoH server, how to report a problem) for
      troubleshooting purpose.  The server MUST support the content-type
      'text/html'.  The DNS client MUST reject the resolver information
      URI if the scheme is not "https".  The client can validate that
      both the encrypted DNS server and the resolver information server
      are owned and managed by the same entity by establishing a TLS
      connection to the domain name in the URL and checking if the
      server certificate includes the name of the encrypted DNS server.
      If this match fails, the DNS client MUST ignore the resolver
      information.  As such, the URL should be treated only as
      diagnostic information for IT staff and it MUST NOT be not
      displayed to the end user.  This is a mandatory attribute.

   New attributes can be defined as per the procedure defined in
   Section 7.2.

   As specified in [RFC7493], the I-JSON object is encoded as UTF8.
   [RFC7493] explicitly allows the returned objects to be in any order.

   Figure 1 shows an example of resolver information.

   {
     "qnameminimization": true,
     "extendeddnserror": [
       15,
       16,
       17
     ],
     "resinfourl": "https://resolver.example.com/guide",
   }

               Figure 1: An Example of Resolver Information







Reddy & Boucadair        Expires October 9, 2022                [Page 4]

Internet-Draft          DNS Resolver Information              April 2022


6.  Security Considerations

   Unless a DNS request to retrieve the resolver information is
   encrypted (e.g., sent over DNS-over-TLS (DoT) [RFC7858] or DNS-over-
   HTTPS (DoH)) [RFC8484], the response is susceptible to forgery.  The
   DNS resolver information can be retrieved after the encrypted
   connection is established to the DNS server or retrieved before the
   encrypted connection is established to the DNS server by using local
   DNSSEC validation.

7.  IANA Considerations

      Note to the RFC Editor: Please update [RFCXXXX] with the RFC
      number to be assigned to this document.

7.1.  RESINFO RRtype

   This document requests IANA to register a new value from the
   "Resource Record (RR) TYPEs" subregistry of the "Domain Name System
   (DNS) Parameters" registry available at [RRTYPE]:

   Type: RESINFO
   Value: TBD
   Meaning: Resolver Information as an I-JSON
   Reference: [RFCXXXX]

7.2.  DNS Resolver Information Registration

   This document requests IANA to create a new registry entitled "DNS
   Resolver Information".  This registry contains definitions of the
   names that can be used to provide the resolver information.

   The registration procedure is Specification Required (Section 4.6 of
   [RFC8126]).

   The structure of the registry is as follows:

   Name:  The name to be used in the JSON object.  The name MUST conform
      to the definition of "string" in I-JSON message format.  The IANA
      registry MUST NOT register names that begin with "temp-", so these
      names can be used freely by any implementer.

   Value Type:  The type of data to be used in the JSON object.

   Description:  Provides a description of the attribute

   Specification:  The reference specification for the registered
      element.



Reddy & Boucadair        Expires October 9, 2022                [Page 5]

Internet-Draft          DNS Resolver Information              April 2022


   The initial content of this registry is provided in Table 1.

   +-------------------+---------+---------------------+---------------+
   | Name              | Value   | Specification       | Specification |
   |                   | Type    |                     |               |
   +-------------------+---------+---------------------+---------------+
   | qnameminimization | boolean | Indicates whether   | [RFCXXXX]     |
   |                   |         | qnameminimization   |               |
   |                   |         | is enabled or not   |               |
   | extendeddnserror  | number  | Lists the set of    | [RFCXXXX]     |
   |                   |         | extended DNS errors |               |
   | clientauth        | boolean | Indicates whether   | [RFCXXXX]     |
   |                   |         | client              |               |
   |                   |         | authentication is   |               |
   |                   |         | required or not     |               |
   | resinfourl        | string  | Provides an         | [RFCXXXX]     |
   |                   |         | unstructured        |               |
   |                   |         | resolver            |               |
   |                   |         | information that is |               |
   |                   |         | used for            |               |
   |                   |         | troubleshooting     |               |
   | identityurl       | string  | Points to a human-  | [RFCXXXX]     |
   |                   |         | friendly            |               |
   |                   |         | description of the  |               |
   |                   |         | resolver identity   |               |
   |                   |         | to display to the   |               |
   |                   |         | end-user            |               |
   +-------------------+---------+---------------------+---------------+

                     Table 1: Initial RESINFO Registry

8.  Acknowledgments

   This specification leverages the work that has been documented in
   [I-D.pp-add-resinfo].

   Thanks to Tommy Jensen, Vittorio Bertola, Vinny Parla, Chris Box, Ben
   Schwartz, Tony Finch, Daniel Kahn Gillmor, Eric Rescorla and Shashank
   Jain for the discussion and comments.

9.  References

9.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.



Reddy & Boucadair        Expires October 9, 2022                [Page 6]

Internet-Draft          DNS Resolver Information              April 2022


   [RFC7159]  Bray, T., Ed., "The JavaScript Object Notation (JSON) Data
              Interchange Format", RFC 7159, DOI 10.17487/RFC7159, March
              2014, <https://www.rfc-editor.org/info/rfc7159>.

   [RFC7493]  Bray, T., Ed., "The I-JSON Message Format", RFC 7493,
              DOI 10.17487/RFC7493, March 2015,
              <https://www.rfc-editor.org/info/rfc7493>.

   [RFC7816]  Bortzmeyer, S., "DNS Query Name Minimisation to Improve
              Privacy", RFC 7816, DOI 10.17487/RFC7816, March 2016,
              <https://www.rfc-editor.org/info/rfc7816>.

   [RFC8126]  Cotton, M., Leiba, B., and T. Narten, "Guidelines for
              Writing an IANA Considerations Section in RFCs", BCP 26,
              RFC 8126, DOI 10.17487/RFC8126, June 2017,
              <https://www.rfc-editor.org/info/rfc8126>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

   [RFC8914]  Kumari, W., Hunt, E., Arends, R., Hardaker, W., and D.
              Lawrence, "Extended DNS Errors", RFC 8914,
              DOI 10.17487/RFC8914, October 2020,
              <https://www.rfc-editor.org/info/rfc8914>.

9.2.  Informative References

   [I-D.ietf-add-ddr]
              Pauly, T., Kinnear, E., Wood, C. A., McManus, P., and T.
              Jensen, "Discovery of Designated Resolvers", draft-ietf-
              add-ddr-06 (work in progress), April 2022.

   [I-D.ietf-add-dnr]
              Boucadair, M., Reddy, T., Wing, D., Cook, N., and T.
              Jensen, "DHCP and Router Advertisement Options for the
              Discovery of Network-designated Resolvers (DNR)", draft-
              ietf-add-dnr-06 (work in progress), March 2022.

   [I-D.pp-add-resinfo]
              Sood, P. and P. Hoffman, "DNS Resolver Information Self-
              publication", draft-pp-add-resinfo-02 (work in progress),
              June 2020.

   [RFC7858]  Hu, Z., Zhu, L., Heidemann, J., Mankin, A., Wessels, D.,
              and P. Hoffman, "Specification for DNS over Transport
              Layer Security (TLS)", RFC 7858, DOI 10.17487/RFC7858, May
              2016, <https://www.rfc-editor.org/info/rfc7858>.



Reddy & Boucadair        Expires October 9, 2022                [Page 7]

Internet-Draft          DNS Resolver Information              April 2022


   [RFC8259]  Bray, T., Ed., "The JavaScript Object Notation (JSON) Data
              Interchange Format", STD 90, RFC 8259,
              DOI 10.17487/RFC8259, December 2017,
              <https://www.rfc-editor.org/info/rfc8259>.

   [RFC8484]  Hoffman, P. and P. McManus, "DNS Queries over HTTPS
              (DoH)", RFC 8484, DOI 10.17487/RFC8484, October 2018,
              <https://www.rfc-editor.org/info/rfc8484>.

   [RFC8499]  Hoffman, P., Sullivan, A., and K. Fujiwara, "DNS
              Terminology", BCP 219, RFC 8499, DOI 10.17487/RFC8499,
              January 2019, <https://www.rfc-editor.org/info/rfc8499>.

   [RRTYPE]   IANA, "Resource Record (RR) TYPEs",
              <http://www.iana.org/assignments/dns-parameters/dns-
              parameters.xhtml#dns-parameters-4>.

Authors' Addresses

   Tirumaleswar Reddy
   Akamai
   Embassy Golf Link Business Park
   Bangalore, Karnataka  560071
   India

   Email: kondtir@gmail.com


   Mohamed Boucadair
   Orange
   Rennes  35000
   France

   Email: mohamed.boucadair@orange.com

















Reddy & Boucadair        Expires October 9, 2022                [Page 8]
